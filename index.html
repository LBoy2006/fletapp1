<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Telegram Mini App</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg-color: #0b0b0b;
      --page-bg-color: #1a1a1a;
      --text-color: #ffffff;
      --nav-bg-color: #2d3748;
      --nav-border-color: #4a5568;
      --nav-text-color: #9ca3af;
      --active-color: #39ff14;
    }

    body.light {
      --bg-color: #ffffff;
      --page-bg-color: #f3f4f6;
      --text-color: #000000;
      --nav-bg-color: #f9fafb;
      --nav-border-color: #e5e7eb;
      --nav-text-color: #6b7280;
      --active-color: #008000;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    .page {
      background-color: var(--page-bg-color);
    }

    nav {
      background-color: var(--nav-bg-color);
      border-color: var(--nav-border-color);
      color: var(--nav-text-color);
    }

    .nav-btn .icon {
      color: blue;
      transition: transform 0.3s;
    }

    .nav-btn.active .icon {
      color: var(--active-color);
      transform: scale(1.25);
    }

    .nav-btn.active {
      color: var(--active-color);
    }
  </style>
</head>
<body class="h-screen flex flex-col">
  <div id="pages" class="flex-grow relative overflow-hidden" style="touch-action: pan-y">
    <div id="pages-wrapper" class="flex h-full transition-transform duration-300" style="transform: translateX(-200%)">
      <section id="leaderboard" class="page w-full h-full flex-shrink-0 overflow-auto p-4">
        <h2 class="text-2xl font-bold mb-4">–õ–∏–¥–µ—Ä–±–æ—Ä–¥</h2>
        <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤.</p>
      </section>
      <section id="task" class="page w-full h-full flex-shrink-0 overflow-auto p-4">
        <h2 class="text-2xl font-bold mb-4">–ó–∞–¥–∞–Ω–∏–µ</h2>
        <p>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è.</p>
      </section>
      <section id="home" class="page w-full h-full flex-shrink-0 overflow-auto p-4">
        <h2 class="text-2xl font-bold mb-4">–ì–ª–∞–≤–Ω–∞—è</h2>
        <p>–ü—Ä–∏–≤–µ—Ç, –°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å!</p>
      </section>
      <section id="collections" class="page w-full h-full flex-shrink-0 overflow-auto p-4">
        <h2 class="text-2xl font-bold mb-4">–†—é–∫–∑–∞–∫</h2>
        <p>–í–∞—à–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã.</p>
      </section>
      <section id="settings" class="page w-full h-full flex-shrink-0 overflow-auto p-4">
        <h2 class="text-2xl font-bold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="mb-4 flex items-center">
          <span class="mr-2">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" id="theme-toggle" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:bg-blue-600 after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
          </label>
        </div>
        <div class="mb-4 flex items-center">
          <span class="mr-2">–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</span>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" id="fullscreen-toggle" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:bg-blue-600 after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
          </label>
        </div>
      </section>
    </div>
  </div>

  <nav class="fixed bottom-0 left-0 right-0 border-t flex text-center text-sm transition-colors">
    <button data-page="leaderboard" class="nav-btn flex-1 py-3 flex flex-col items-center rounded">
      <i class="fas fa-trophy icon text-xl mb-1"></i>
      <span>–õ–∏–¥–µ—Ä–±–æ—Ä–¥</span>
    </button>
    <button data-page="task" class="nav-btn flex-1 py-3 flex flex-col items-center rounded">
      <i class="fas fa-clipboard-list icon text-xl mb-1"></i>
      <span>–ó–∞–¥–∞–Ω–∏–µ</span>
    </button>
    <button data-page="home" class="nav-btn flex-1 py-3 flex flex-col items-center rounded">
      <i class="fas fa-home icon text-xl mb-1"></i>
      <span>–ì–ª–∞–≤–Ω–∞—è</span>
    </button>
    <button data-page="collections" class="nav-btn flex-1 py-3 flex flex-col items-center rounded">
      <i class="fas fa-boxes icon text-xl mb-1"></i>
      <span>–†—é–∫–∑–∞–∫</span>
    </button>
    <button data-page="settings" class="nav-btn flex-1 py-3 flex flex-col items-center rounded">
      <i class="fas fa-cog icon text-xl mb-1"></i>
      <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
    </button>
  </nav>

 <script>
  const wrapper = document.getElementById('pages-wrapper');
  const buttons = document.querySelectorAll('.nav-btn');
  const themeToggle = document.getElementById('theme-toggle');
  const fullscreenToggle = document.getElementById('fullscreen-toggle');
  const pageOrder = ['leaderboard', 'task', 'home', 'collections', 'settings'];
  let currentIndex = pageOrder.indexOf('home');

  function updateTransform() {
    wrapper.style.transform = `translateX(-${currentIndex * 100}%)`;
  }

  function showPage(id) {
    currentIndex = pageOrder.indexOf(id);
    updateTransform();
    buttons.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.page === id);
    });
  }

  function applyTheme(theme) {
    document.body.classList.toggle('light', theme === 'light');
  }

  function initTheme() {
    const saved = localStorage.getItem('theme') || 'dark';
    applyTheme(saved);
    themeToggle.checked = saved === 'dark';
  }

  function initFullscreen() {
    if (window.Telegram?.WebApp) {
      fullscreenToggle.checked = Telegram.WebApp.isFullscreen === true;
    }
  }

  function applySafeInsets() {
    const isFullscreen = Telegram.WebApp.isFullscreen;
    const safeInset = Telegram.WebApp.contentSafeAreaInset;

    if (safeInset) {
      document.getElementById('pages').style.paddingBottom = `${safeInset.bottom}px`;
      document.querySelector('nav').style.bottom = `${safeInset.bottom}px`;
    }

    document.querySelectorAll('.page').forEach(page => {
      if (isFullscreen && safeInset) {
        const insetTop = parseInt(safeInset.top) || 0;
        const extraOffset = 48;
        page.style.paddingTop = `${insetTop + extraOffset}px`;
      } else {
        page.style.paddingTop = '';
      }
    });
  }

  // üëâ –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤—Å—ë –≤ Telegram.WebApp.ready()
  if (window.Telegram?.WebApp) {
    Telegram.WebApp.ready();

    initTheme();
    initFullscreen();
    applySafeInsets();
    showPage('home');

    // —Ç–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    buttons.forEach(btn => {
      btn.addEventListener('click', () => showPage(btn.dataset.page));
    });

    fullscreenToggle.addEventListener('change', async () => {
      if (!window.Telegram?.WebApp) return;

      if (fullscreenToggle.checked) {
        await Telegram.WebApp.requestFullscreen();
      } else {
        await Telegram.WebApp.exitFullscreen();
      }

      setTimeout(() => {
        applySafeInsets();
      }, 100);
    });
  }

  // —Å–≤–∞–π–ø—ã
  const container = document.getElementById('pages');
  let startX = null;

  container.addEventListener('touchstart', e => {
    if (e.touches.length === 1) {
      startX = e.touches[0].clientX;
    }
  });

  container.addEventListener('touchend', e => {
    if (startX === null) return;
    const deltaX = e.changedTouches[0].clientX - startX;
    if (Math.abs(deltaX) > 50) {
      if (deltaX < 0 && currentIndex < pageOrder.length - 1) {
        showPage(pageOrder[currentIndex + 1]);
      } else if (deltaX > 0 && currentIndex > 0) {
        showPage(pageOrder[currentIndex - 1]);
      }
    }
    startX = null;
  });
</script>

</body>
</html>
